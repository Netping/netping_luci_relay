
# RELAY ADAPTER TEMPLATE
# ======================

config 'relay' template
	option memo '0'
	option embedded '0'
	option state_on '0'
	option state_off '0'
	option state '0'
	option restart_time '0'
	option status '0'
	option proto '0'

# RELAY DATA
# ==========

config relay
	option id 'relay_1'
	option title 'Пожарная сигнализация'
	option embedded '0'
	option restart_time '120'
	option state '1'
	option status '2'
	option proto 'http_1'

config relay
	option id 'relay_2'
	option title 'Серверный шкаф 1'
	option embedded '0'
	option restart_time '120'
	option state '1'
	option status '2'
	option proto 'http_2'

config relay
	option id 'relay_3'
	option title 'Резервный сервер'
	option embedded '0'
	option restart_time '120'
	option state '1'
	option status '2'
	option proto 'snmp_1'


# PROTOCOL ADAPTER TEMPLATES
# ==========================

config 'http' template
	option address '0.0.0.0'
	optio port '0'
	option login '0'
	option password '0'

config 'snmp' template
	option address '0'
	option port '0'
	optio community '0'


# PROTOCOL DATA
# =============

config http
	option id 'http_1'
	option address '192.168.0.1'
	optio port '65535'
	option login 'user'
	option password 'pass'

config http
	option id 'http_2'
	option address '192.168.0.1'
	optio port '65535'
	option login 'user'
	option password 'pass'

config snmp
	option id 'snmp_1'
	option address '.0.1.2.3.4.500'
	option port '61'
	optio community 'helloworld'	


# MODAL-WIDGET - RELAY ADAPTER SETTINGS
# =====================================

config 'relay.memo' modal
	option source 'user'
	option inputtype 'string'
	option validate 'string.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother '0'
	option label 'Памятка'

config 'relay.embedded' modal
	option source 'config'
	list visibility 'widget.modal.relay_settings'
	option oldbrother 'relay.memo'
	option label 'Встроенное'

config 'relay.state_on' modal
	option source 'user'
	option inputtype 'string'
	option validate 'string.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother 'relay.embedded'
	option label 'Имя состояния ВКЛ.'

config 'relay.state_off' modal
	option source 'user'
	option inputtype 'string'
	option validate 'string.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother 'relay.state_on'
	option label 'Имя состояния ВЫКЛ.'

config 'relay.proto' modal
	option source 'ubus'
	option source_command 'ubus call relay list \'{"type": "protocol"}\''
	option inputtype 'list'
	list visibility 'widget.modal.relay_settings'
	option oldbrother 'relay.state_off'
	option label 'Протокол'

config 'relay.restart_time' modal
	option source 'user'
	option inputtype 'number'
	option validate 'number.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother 'relay.proto'
	option label 'Протокол'

# MODAL-WIDGET - PROTOCOL ADAPTER SETTINGS
# ========================================

config 'relay.proto.http.address' modal
	option source 'user'
	option inputtype 'string'
	option validate 'ip_colon_port.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother '0'
	option label 'Адрес и порт сервера'

config 'relay.proto.http.login' modal
	option source 'user'
	option inputtype 'string'
	option validate 'login.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother 'relay.proto.http.address'
	option label 'Имя пользователя'

config 'relay.proto.http.password' modal
	option source 'user'
	option inputtype 'string'
	option validate 'password.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother 'relay.proto.http.login'
	option label 'Пароль'

config 'relay.proto.snmp.address' modal
	option source 'user'
	option inputtype 'string'
	option validate 'snmp_address.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother '0'
	option label 'SNMP-адрес'

config 'relay.proto.snmp.port' modal
	option source 'user'
	option inputtype 'string'
	option validate 'snmp_port.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother 'relay.proto.snmp.address'
	option label 'SNMP-порт'

config 'relay.proto.snmp.community' modal
	option source 'user'
	option inputtype 'string'
	option validate 'alpha_numerical.ne'
	list visibility 'widget.modal.relay_settings'
	option oldbrother 'relay.proto.snmp.port'
	option label 'SNMP-порт'